import{r as o,o as c,c as l,a as s,b as t,w as e,F as i,e as n,d as p}from"./app.9c809a05.js";import{_ as u}from"./plugin-vue_export-helper.21dcd24c.js";const r={},k=s("h1",{id:"quick-start",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#quick-start","aria-hidden":"true"},"#"),n(" Quick start")],-1),d=s("p",null,"Explain how to use our SDK",-1),b=s("h2",{id:"initialize",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#initialize","aria-hidden":"true"},"#"),n(" Initialize")],-1),m=n("Get our "),h=n("BravBleApi"),g=n(" and set the event callback object."),v=n("The entry is: "),f=n("BravApiProvider"),_=s("p",null,"It is best to set up a log listener to record the SDK logs for subsequent troubleshooting.",-1),y=s("p",null,[s("strong",null,"android")],-1),w=n("Need to call "),B=n("BravApiProvider.initSharedbleApi(Context)"),S=n(" first"),L=n("Then you can use "),A=n("BravApiProvider.sharedBleApi()"),C=n(" to get the Bluetooth API object"),E=p(`<div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code>BravLogger<span class="token punctuation">.</span>loggerLevel <span class="token operator">=</span> BravLogger<span class="token punctuation">.</span>LOG_LEVEL_ALL
BravLogger<span class="token punctuation">.</span><span class="token function">setLoggerListener</span><span class="token punctuation">(</span><span class="token keyword">object</span> <span class="token operator">:</span>BravLoggerListener<span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onLog</span><span class="token punctuation">(</span>tag<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">,</span> text<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//do save log</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onError</span><span class="token punctuation">(</span>error<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">,</span> text<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//do save log</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//Can be placed in the onCreate method of Application, just call it once</span>
BravApiProvider<span class="token punctuation">.</span><span class="token function">initSharedBleApi</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>

<span class="token keyword">val</span> bleApi <span class="token operator">=</span> BravApiProvider<span class="token punctuation">.</span><span class="token function">sharedBleApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>



</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>iOS</strong></p><div class="language-swift ext-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">import</span> <span class="token class-name">BravLib</span>

<span class="token class-name">BravLogger</span><span class="token punctuation">.</span>loggerLevel <span class="token operator">=</span> <span class="token class-name">BravLogger</span><span class="token punctuation">.</span><span class="token constant">LOG_LEVEL_ALL</span>
<span class="token class-name">BravLogger</span><span class="token punctuation">.</span>loggerDelegate <span class="token operator">=</span> loggerDelegate

<span class="token class-name">BravApiProvider</span><span class="token punctuation">.</span><span class="token function">initSharedBleApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        
<span class="token keyword">let</span> bleApi <span class="token operator">=</span> <span class="token class-name">BravApiProvider</span><span class="token punctuation">.</span>sharedBleApi


</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><blockquote><p>The document does not provide Java and Objective-C code examples, please convert according to kotlin and swift</p></blockquote><h2 id="preliminary-work" tabindex="-1"><a class="header-anchor" href="#preliminary-work" aria-hidden="true">#</a> preliminary work</h2><p><strong>android</strong></p><ol><li>Check whether the APP has obtained the positioning permission, if not, you need to apply for the permission.</li></ol><p>For mobile phones with Android 6.0 and above, Bluetooth scanning has been classified as part of the positioning service. If you use Bluetooth to scan the device, the APP must obtain the positioning permission.</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token comment">//Check and apply for permission</span>
<span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">checkPermissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> permissions <span class="token operator">=</span> <span class="token function">arrayOf</span><span class="token punctuation">(</span>Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>ACCESS_FINE_LOCATION<span class="token punctuation">)</span>
    <span class="token keyword">val</span> permissionDeniedList<span class="token operator">:</span> MutableList<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>permission <span class="token keyword">in</span> permissions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> permissionCheck <span class="token operator">=</span> ContextCompat<span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> permission<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>permissionCheck <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">onPermissionGranted</span><span class="token punctuation">(</span>permission<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            permissionDeniedList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>permission<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>permissionDeniedList<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> deniedPermissions <span class="token operator">=</span> permissionDeniedList<span class="token punctuation">.</span><span class="token function">toTypedArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ActivityCompat<span class="token punctuation">.</span><span class="token function">requestPermissions</span><span class="token punctuation">(</span>
            <span class="token keyword">this</span><span class="token punctuation">,</span>
            deniedPermissions<span class="token punctuation">,</span>
            REQUEST_CODE_PERMISSION_LOCATION
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//Other detailed codes can be searched online by yourself</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><ol start="2"><li>Check whether the location service is enabled <blockquote><p>It has been tested and verified that most of the current Android phones need to turn on the location service to scan the surrounding devices using Bluetooth.</p></blockquote></li></ol><p>It is recommended to check whether the location service is turned on before scanning. If it is not turned on, the user will be prompted to turn it on.</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">checkGPSIsOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Boolean <span class="token punctuation">{</span>
    <span class="token keyword">val</span> locationManager <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSystemService</span><span class="token punctuation">(</span>LOCATION_SERVICE<span class="token punctuation">)</span> <span class="token keyword">as</span> LocationManager
    <span class="token keyword">return</span> locationManager<span class="token punctuation">.</span><span class="token function">isProviderEnabled</span><span class="token punctuation">(</span>LocationManager<span class="token punctuation">.</span>GPS_PROVIDER<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div>`,12),D={start:"3"},q=n("Check whether Bluetooth is enabled, this SDK provides API, "),I=n("BravBleApi.bleEnableState"),P=p(`<div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>bleApi<span class="token punctuation">.</span>bleEnableState <span class="token operator">!=</span> BravBleEnableState<span class="token punctuation">.</span>Enable<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">//Here is the prompt that bluetooth is not turned on</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>iOS</strong></p><p>After initializing the API, you need to wait until the callback <code>state == BravBleEnableState.Enable</code> in [BravBleEventDelegate.onBleEnableStateChange]to perform Bluetooth scanning.</p><p>After the iOS mechanism is initialized, the callback will generally be delayed for 100-500ms. If you want to use it immediately after initialization, you can do a delay processing.</p><h2 id="scan-device" tabindex="-1"><a class="header-anchor" href="#scan-device" aria-hidden="true">#</a> scan device</h2>`,5),O=n("Bluetooth scan using "),x=n("BravBleApi.startScan"),M=p(`<p><strong>android</strong></p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code>
<span class="token keyword">private</span> <span class="token keyword">val</span> bleEventListener <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> BravBleEventListener <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onBleEnableStateChange</span><span class="token punctuation">(</span>state<span class="token operator">:</span> BravBleEnableState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;ble&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;onBleEnableStateChange&quot;</span></span> <span class="token operator">+</span> state<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token comment">//Process the scanned device here</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onBravDeviceFound</span><span class="token punctuation">(</span>device<span class="token operator">:</span> BravDevice<span class="token punctuation">)</span> <span class="token punctuation">{</span>


    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onConnectionChange</span><span class="token punctuation">(</span>deviceId<span class="token operator">:</span> String<span class="token punctuation">,</span> state<span class="token operator">:</span> BravDeviceConnectionState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;ble&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;onConnectionChange &quot;</span></span> <span class="token operator">+</span> state<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token comment">//where this.bleEventListener is the object of BravBleEventListener. Note here that if it is not used, it needs to be set to null to avoid memory leaks</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>bleApi<span class="token punctuation">.</span><span class="token function">setBleEventListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>bleEventListener<span class="token punctuation">)</span>


<span class="token comment">//start scanning</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>bleApi<span class="token punctuation">.</span><span class="token function">startScan</span><span class="token punctuation">(</span><span class="token function">BravScanOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment">//Stop scanning, usually when exiting the device interface</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>bleApi<span class="token punctuation">.</span><span class="token function">stopScan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p><strong>iOS</strong></p><div class="language-swift ext-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">BleModel</span><span class="token punctuation">:</span> <span class="token class-name">ObservableObject</span><span class="token punctuation">,</span> <span class="token class-name">BravBleEventDelegate</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> tag <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;BleModel&quot;</span></span>
    
    
    <span class="token keyword">func</span> <span class="token function-definition function">onBleEnableStateChange</span><span class="token punctuation">(</span>state<span class="token punctuation">:</span> <span class="token class-name">BleEnableState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BravLogger</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&quot;onBleEnableStateChange: &quot;</span></span><span class="token punctuation">,</span>state<span class="token punctuation">.</span>rawValue<span class="token punctuation">)</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>bleEnableState <span class="token operator">=</span> state
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">onBravDeviceFound</span><span class="token punctuation">(</span>device<span class="token punctuation">:</span> <span class="token class-name">BravDevice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BravLogger</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&quot;device found </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">device<span class="token punctuation">.</span>mac</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">onConnectionChange</span><span class="token punctuation">(</span>deviceId<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> state<span class="token punctuation">:</span> <span class="token class-name">BravDeviceConnectionState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token class-name">BravLogger</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&quot;connection state change\uFF1A</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">deviceId</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">state</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>

<span class="token keyword">self</span><span class="token punctuation">.</span>bleApi<span class="token punctuation">.</span><span class="token function">setBleEventListener</span><span class="token punctuation">(</span><span class="token class-name">BleModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">self</span><span class="token punctuation">.</span>bleApi<span class="token punctuation">.</span><span class="token function">startScan</span><span class="token punctuation">(</span><span class="token class-name">BravScanOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">self</span><span class="token punctuation">.</span>bleApi<span class="token punctuation">.</span><span class="token function">stopScan</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>After scanning to the device, you can display the processing, let the user choose the processing method, or directly call the connected device</p><p>In addition, the scanned device can judge the device type according to <code>device.category</code>, and then convert it to the corresponding sub-device type</p>`,6),R=n("Currently SDK only supports body fat scale, so device.category is "),j=n("BravDeviceCategory"),G=n("-and-device-object-is-"),N=n("bravscaledevice"),T=p(`<h2 id="connect-device" tabindex="-1"><a class="header-anchor" href="#connect-device" aria-hidden="true">#</a> connect device</h2><p>You need to use different event monitoring interfaces and options according to different device types.</p><p><strong>Connecting the Body Fat Scale</strong></p><p><strong>android</strong></p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">private</span> <span class="token keyword">val</span> connectionChangeListener <span class="token operator">=</span>
        BravBleConnectionChangeListener <span class="token punctuation">{</span> deviceId<span class="token punctuation">,</span> state <span class="token operator">-&gt;</span>
            Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;BravBleConnectionChangeListener &quot;</span></span> <span class="token operator">+</span> state<span class="token punctuation">)</span>

        <span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">val</span> scaleEventLister <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> BravScaleEventListener <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onGetUnsteadyWeight</span><span class="token punctuation">(</span>deviceId<span class="token operator">:</span> String<span class="token punctuation">,</span> weight<span class="token operator">:</span> Double<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isAdded<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        binding<span class="token punctuation">.</span>weightTv<span class="token punctuation">.</span>text <span class="token operator">=</span> String<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;%02f kg&quot;</span></span><span class="token punctuation">,</span> weight<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onMeasureComplete</span><span class="token punctuation">(</span>deviceId<span class="token operator">:</span> String<span class="token punctuation">,</span> scaleData<span class="token operator">:</span> BravScaleData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;End of measurement: &quot;</span></span> <span class="token operator">+</span> scaleData<span class="token punctuation">.</span>bodyfatRate<span class="token punctuation">)</span>

        <span class="token function">turnToReport</span><span class="token punctuation">(</span>scaleData<span class="token punctuation">)</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onGetOfflineData</span><span class="token punctuation">(</span>deviceId<span class="token operator">:</span> String<span class="token punctuation">,</span> scaleDataList<span class="token operator">:</span> Array<span class="token operator">&lt;</span>BravScaleOriginData<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;Received offline data&quot;</span></span> <span class="token operator">+</span> scaleDataList<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token function">doConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">val</span> result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bleApi<span class="token punctuation">.</span><span class="token function">connectDevice</span><span class="token punctuation">(</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>deviceId<span class="token punctuation">,</span>
      <span class="token function">BravScaleDataOptions</span><span class="token punctuation">(</span>
          <span class="token function">BravScaleUser</span><span class="token punctuation">(</span>
              BravGender<span class="token punctuation">.</span>Male<span class="token punctuation">,</span>
              <span class="token number">170</span><span class="token punctuation">,</span>
              <span class="token number">30</span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span> BravScaleUnit<span class="token punctuation">.</span>kg
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      scaleEventLister<span class="token punctuation">,</span>
      connectionChangeListener
  <span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>isSuccess<span class="token punctuation">)</span><span class="token punctuation">{</span>
      scaleHandler <span class="token operator">=</span> result<span class="token punctuation">.</span>data <span class="token keyword">as</span> BroadcastScaleHandler

  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      scaleHandler<span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      Log<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;connect fail&quot;</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p><strong>iOS</strong></p><div class="language-swift ext-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">MeasureModel</span><span class="token punctuation">:</span><span class="token class-name">BravScaleEventDelegate</span><span class="token punctuation">,</span><span class="token class-name">BravBleConnectionChangeDelegate</span><span class="token punctuation">{</span>
  
  <span class="token keyword">let</span> tag <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;MeasureModel&quot;</span></span>
  <span class="token keyword">func</span> <span class="token function-definition function">onGetUnsteadyWeight</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> deviceId<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token omit keyword">_</span> weight<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BravLogger</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&quot;onGetUnsteadyWeight\uFF1A</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">weight</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> %&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">onMeasureComplete</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> deviceId<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token omit keyword">_</span> scaleData<span class="token punctuation">:</span> <span class="token class-name">BravScaleData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">BravLogger</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&quot;Measure compliete bodyfat percentage\uFF1A</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">scaleData<span class="token punctuation">.</span>bodyfatRate</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> %&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">onGetOfflineData</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> deviceId<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token omit keyword">_</span> scaleDataList<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">BravOriginData</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BravLogger</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;Received\uFF1A </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">scaleDataList<span class="token punctuation">.</span>count</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">onConnectionChange</span><span class="token punctuation">(</span>deviceId<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> state<span class="token punctuation">:</span> <span class="token class-name">BravDeviceConnectionState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BravLogger</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span><span class="token string-literal"><span class="token string">&quot;connection state change\uFF1A</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">deviceId</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">state</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

 <span class="token keyword">func</span> <span class="token function-definition function">doConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token class-name">BravScaleUser</span><span class="token punctuation">(</span>gender<span class="token punctuation">:</span><span class="token punctuation">.</span><span class="token class-name">Female</span><span class="token punctuation">,</span>height<span class="token punctuation">:</span><span class="token number">180</span><span class="token punctuation">,</span>age<span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token class-name">BravScaleDataOptions</span><span class="token punctuation">(</span>user<span class="token punctuation">:</span>user <span class="token punctuation">,</span>unit<span class="token punctuation">:</span> <span class="token punctuation">.</span>kg<span class="token punctuation">)</span>
    
    <span class="token keyword">let</span> <span class="token omit keyword">_</span> <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>bleApi<span class="token punctuation">.</span><span class="token function">connectDevice</span><span class="token punctuation">(</span>deviceId<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>device<span class="token punctuation">.</span>deviceId<span class="token punctuation">,</span> options<span class="token punctuation">:</span>options <span class="token punctuation">,</span> listener<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>measureModel<span class="token punctuation">,</span> connectionChangeListener<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>measureModel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div>`,7),F=n("Use the "),U=n("BravBleApi.connectDevice"),V=n(" method"),z=n("options "),H=n("BravScaleDataOptions"),K=n(",-which-needs-to-be-passed-in-"),W=n("user:bravuser"),Q=n("-object-and-"),Y=n("unit:bravscaleunit"),J=n("scaleEventLister is "),X=n("BravScaleEventListener"),Z=n(" object, used to receive body fat scale data callback"),$=s("blockquote",null,[s("p",null,[n("Among them, "),s("code",null,"user"),n(" is used to pass in the user information of the body fat scale, which will be used to calculate the body data, and "),s("code",null,"unit"),n(" is used to set the weighing unit of the body fat scale.")])],-1),nn=n("connectionChangeListener is the "),sn=n("BravBleConnectionChangeListener"),an=n(" object, which is used to receive changes in the connection state of the device. To facilitate the processing of redundant interfaces added by the measurement interface logic, you can pass null"),tn=n("Return value: "),en=n("BroadcastScaleHandler"),pn=n(" temporarily useless"),on=n("After the measurement is over, the APP will receive the complete measurement data "),cn=n("BravScaleData"),ln=n(" in the onMeasureComplete method of BravScaleEventListener. After receiving, it means that the user has completed the measurement."),un=n("If the user leaves the measurement interface or wants to end the measurement, he can call "),rn=n("BravBleApi.disconnectDevice"),kn=n(" to disconnect from the device."),dn=s("h2",{id:"measurement-interface-logic-processing",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#measurement-interface-logic-processing","aria-hidden":"true"},"#"),n(" Measurement interface logic processing")],-1),bn=s("p",null,"You can display the real-time weight on the scale like a demo or our APP (BravFit)",-1),mn=s("p",null,"It is best to show some measurement animations to remind the user that the APP is still connecting with the scale.",-1),hn=s("p",null,"After the measurement, it is recommended to display the measurement report immediately so that the user can view the measurement data just now.",-1),gn=s("h2",{id:"show-measurement-report",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#show-measurement-report","aria-hidden":"true"},"#"),n(" show measurement report")],-1),vn=s("p",null,"In the Android and iOS demos, there is a method to show how to display the measurement report. Refer to the demo, and then design a beautiful UI to display the report.",-1);function fn(_n,yn){const a=o("RouterLink");return c(),l(i,null,[k,d,b,s("p",null,[m,t(a,{to:"/api.html#bravbleapi"},{default:e(()=>[h]),_:1}),g]),s("p",null,[v,t(a,{to:"/api.html#bravapiprovider"},{default:e(()=>[f]),_:1})]),_,y,s("p",null,[w,t(a,{to:"/api.html#initsharedbleapi"},{default:e(()=>[B]),_:1}),S]),s("p",null,[L,t(a,{to:"/api.html#sharedbleapi"},{default:e(()=>[A]),_:1}),C]),E,s("ol",D,[s("li",null,[q,t(a,{to:"/api.html#getbleenablestate"},{default:e(()=>[I]),_:1})])]),P,s("p",null,[O,t(a,{to:"/api.html#startscan"},{default:e(()=>[x]),_:1})]),M,s("blockquote",null,[s("p",null,[R,t(a,{to:"/api.html#bravdevicecategory"},{default:e(()=>[j]),_:1}),G,t(a,{to:"/api.html#bravscaledevice"},{default:e(()=>[N]),_:1})])]),T,s("p",null,[F,t(a,{to:"/api.html#connectdevice"},{default:e(()=>[U]),_:1}),V]),s("ul",null,[s("li",null,[s("p",null,[z,t(a,{to:"/api.html#bravscaledataoptions"},{default:e(()=>[H]),_:1}),K,t(a,{to:"/api.html#bravscaleuser"},{default:e(()=>[W]),_:1}),Q,t(a,{to:"/api.html#bravscaleunit"},{default:e(()=>[Y]),_:1})])]),s("li",null,[s("p",null,[J,t(a,{to:"/api.html#bravscaleeventlistener"},{default:e(()=>[X]),_:1}),Z]),$]),s("li",null,[s("p",null,[nn,t(a,{to:"/api.html#bravbleconnectionchangelistener"},{default:e(()=>[sn]),_:1}),an])]),s("li",null,[s("p",null,[tn,t(a,{to:"/api.html#broadcastscalehandler"},{default:e(()=>[en]),_:1}),pn])])]),s("p",null,[on,t(a,{to:"/api.html#bravscaledata"},{default:e(()=>[cn]),_:1}),ln]),s("p",null,[un,t(a,{to:"/api.html#disconnectdevice"},{default:e(()=>[rn]),_:1}),kn]),dn,bn,mn,hn,gn,vn],64)}var Sn=u(r,[["render",fn]]);export{Sn as default};
