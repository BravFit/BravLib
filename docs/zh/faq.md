---
sidebar: auto
---
# 常见问题

## APP逻辑设计相关
### 是否需要绑定或配对设备？
这里需要弄清一个概念，问题中提到的绑定或配对，是指在安卓/iOS中添加配对的蓝牙设备。通常一些标准设备是会需要的，比如蓝牙耳机，手写笔，手环。这些会需要在手机系统的蓝牙设置进行设置。但我们的秤不用，具体我们会在下问说明

蓝牙4.0，也就是BLE，是不需要绑定蓝牙设备就可以直接使用。我们的秤使用的私有协议，无法通过手机系统蓝牙直接使用，市面上面几乎所有的体脂秤都是如此。我们APP（BravFit）中的添加设备，仅仅让APP记住用户的秤，并非是手机系统的蓝牙配对。添加设备的过程也是引导用户如何使用体脂称。我们小程序是做成简单粗暴的方式，不用添加秤直接打开后，就上秤连接测量。

客户这边可自行决定是否需要添加该逻辑，建议如果是做成APP的一个小功能模块，是可以直接做成类似我们小程序那样，直接上秤测量，展示数据。

### 如何做成用户踩秤后，APP马上响应
我们自己的APP（BravFit），在正常使用中，是让用户打开APP，踩亮秤，就马上测量，这样可以减少用户的操作步骤。其实说白了，就是打开APP后，APP自动调用SDK的一整套逻辑，无需用户点击选择设备之类的。具体实现步骤如下：
1. 进入测量界面后，检查蓝牙状态
2. 蓝牙已打开，开始扫描
3. 扫描到体脂秤，判断是否为已添加设备或者无需判断就直接连接（该处视APP的逻辑不同而不同）
4. 连接成功，展示测量动画
5. 测量完成，展示测量结果

### 测量完成后，是否需要立马断开蓝牙连接
通常无需主动断开与秤的连接，除非用户退出测量界面。

如果需要测量立马断开连接，最好也能够延时2s断开。

### 数据如何分析

可以参考demo中的report部分
## SDK功能相关

### 连接设备一直无法成功或者成功后很快就断开连接
- 检查设备是否被其他人连接了
- 在系统蓝牙中查看是否当前连接的设备已经被配对,如果已经配对，需要取消配对
- 部分手机需要先扫描才能连接成功，先扫描设备再进行连接

### 调用扫描成功且踩亮秤后，没有设备返回
- 检查是否对**ACCESS_COARSE_LOCATION**和**ACCESS_FINE_LOCATION**都进行了申请，SDK中对2个权限都进行了校验
- 是否编译版本26以及以上，如果是，2个权限都需要单独申请(8.0的新特性)

>安卓6.0以上，谷歌把蓝牙归类为定位功能的一部分，使用蓝牙扫描时，需要用户授权定位权限，不然调用扫描时，系统会提示需要定位权限
>不打开定位服务开关时，也是有可能无法扫描到设备，原生大多数如此

### 测量完成后没有体脂率等数据

1. 是否有脱鞋进行测量。穿鞋测量时，无法测到生物阻抗，所以无法计算体脂率等指标

### 扫描不到设备，该如何处理
1. 检查是否打开蓝牙、是否有踩亮秤，手机是否跟秤相距过远（超过10米）
1. 检查所扫描的设备，是否已经被其他人连接
2. 如果是Android，则可以检查下是否有定位权限，另外是否有打开定位服务开关
3. 尝试重启蓝牙，再不行，重启蓝牙试试。

## 其他问题

### 是否可以给到体脂率等指标的计算方法？

暂时无法提供


### 什么是离线数据

普通蓝牙秤在称重时未连接手机的情况下，秤会把数据存在秤体内，等下次连接蓝牙时，会把这些数据传给APP

由于SDK无法识别该用户是谁的，所以会把这个数据交由APP来分配，分配用户可以交给SDK来计算完整数据。

### 可否提供蓝牙协议

原则上我们不会提供蓝牙协议，如果实在需要，可以跟我们的商务/销售沟通

### 为什么我们使用SDK测量出来的数据BravFit的数据会有差异

比对[BravScaleUser](api.md#bravscaleuser)中的所有属性是否完全一致，如果完全一致则可以咨询开发者
### 线上版本出现蓝牙连接异常后，怎么排查问题
先查清用户的手机型号，如果可以的话，尽量使用跟客户同样的型号来测试。

注册日志输出接口[QNLogListener](../api/QNLogListener.md)，记录相关日志（可以保存日志文件），发给我司开发人员进行分析。
